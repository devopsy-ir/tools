#!/bin/sh

PATCH="yv66vgAAADEBNwoAVACxCgADALIHALMKAEAAtAoAQAC1CgBAALYKALcAuAoAQAC5CgC3ALoKALcAuwcAvAoAAwC9CgADAL4KAAMAvwoAAwDABwDBCgAQAMIJAAMAwwoAEADEBwDFBwDGCgAVALEKABQAxwcAyAgAyQoAGADKBwDLBwDMCgAcAM0HAM4KAB4AsQgAzwoAHgDQCADRCgAeANIKABwA0woAQADUCgDVANYHANcKACcA2AoAJwDZCgAnANoKACcA2wcA3AcA3QoALQCxBwDeCgAvALEKAC8A3wgA4AoAQADhBwDiCgA0AOMKAOQA5QoANADmCgA0ANIHAOcKADkAsQcA6AoAOwDpCgA7AOoKADsA6woAOQDsBwDtCgDVAO4KAEAAwgoAQADvCgAeAPAIAPEKAB4A8goAtwDzCgADAPQIAPUIAPYKAPcA+AcA+QoATADCCgD3APoJAAMA+wcA/AcA/QoAUQDNBwD+BwD/AQAQVkVSU0lPTl9OVU1CRVJfMQEAAUkBAA1Db25zdGFudFZhbHVlAwAAAAEBABBWRVJTSU9OX05VTUJFUl8yAwAAAAIBAA5WRVJTSU9OX0xFTkdUSAMAAAADAQAbRU5DT0RFRF9MSUNFTlNFX0xFTkdUSF9CQVNFAwAAAB8BAA5MSUNFTlNFX1BSRUZJWAEAAltCAQAJU0VQQVJBVE9SAQABQwMAAABYAQAKUFVCTElDX0tFWQEAGUxqYXZhL3NlY3VyaXR5L1B1YmxpY0tleTsBABtFTkNPREVEX0xJQ0VOU0VfTElORV9MRU5HVEgDAAAATAEABjxpbml0PgEAAygpVgEABENvZGUBAA9MaW5lTnVtYmVyVGFibGUBABJMb2NhbFZhcmlhYmxlVGFibGUBAAR0aGlzAQA4TGNvbS9hdGxhc3NpYW4vZXh0cmFzL2RlY29kZXIvdjIvVmVyc2lvbjJMaWNlbnNlRGVjb2RlcjsBAAljYW5EZWNvZGUBABUoTGphdmEvbGFuZy9TdHJpbmc7KVoBAAd2ZXJzaW9uAQAJbGVuZ3RoU3RyAQASTGphdmEvbGFuZy9TdHJpbmc7AQAUZW5jb2RlZExpY2Vuc2VMZW5ndGgBAA1saWNlbnNlU3RyaW5nAQADcG9zAQAIZG9EZWNvZGUBACooTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL3V0aWwvUHJvcGVydGllczsBABllbmNvZGVkTGljZW5zZVRleHRBbmRIYXNoAQASemlwcGVkTGljZW5zZUJ5dGVzAQALbGljZW5zZVRleHQBABBMamF2YS9pby9SZWFkZXI7AQARZ2V0TGljZW5zZVZlcnNpb24BAAMoKUkBAAl1bnppcFRleHQBABQoW0IpTGphdmEvaW8vUmVhZGVyOwEAAWUBACZMamF2YS9pby9VbnN1cHBvcnRlZEVuY29kaW5nRXhjZXB0aW9uOwEAAmluAQAeTGphdmEvaW8vQnl0ZUFycmF5SW5wdXRTdHJlYW07AQAFemlwSW4BACNMamF2YS91dGlsL3ppcC9JbmZsYXRlcklucHV0U3RyZWFtOwEAEWdldExpY2Vuc2VDb250ZW50AQAmKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL1N0cmluZzsBACFMamF2YS9sYW5nL051bWJlckZvcm1hdEV4Y2VwdGlvbjsBABZjaGVja0FuZEdldExpY2Vuc2VUZXh0AQAWKExqYXZhL2xhbmcvU3RyaW5nOylbQgEADGRlY29kZWRCeXRlcwEAA2RJbgEAGUxqYXZhL2lvL0RhdGFJbnB1dFN0cmVhbTsBAAp0ZXh0TGVuZ3RoAQAEaGFzaAEAFUxqYXZhL2lvL0lPRXhjZXB0aW9uOwEADmxpY2Vuc2VDb250ZW50AQAYbG9hZExpY2Vuc2VDb25maWd1cmF0aW9uAQAoKExqYXZhL2lvL1JlYWRlcjspTGphdmEvdXRpbC9Qcm9wZXJ0aWVzOwEABXByb3BzAQAWTGphdmEvdXRpbC9Qcm9wZXJ0aWVzOwEABHRleHQBABFyZW1vdmVXaGl0ZVNwYWNlcwEAAWkBAAtsaWNlbnNlRGF0YQEABWNoYXJzAQACW0MBAANidWYBABhMamF2YS9sYW5nL1N0cmluZ0J1ZmZlcjsBAAtwYWNrTGljZW5zZQEAGChbQltCKUxqYXZhL2xhbmcvU3RyaW5nOwEAA291dAEAH0xqYXZhL2lvL0J5dGVBcnJheU91dHB1dFN0cmVhbTsBAARkT3V0AQAaTGphdmEvaW8vRGF0YU91dHB1dFN0cmVhbTsBAAdhbGxEYXRhAQAGcmVzdWx0AQAKRXhjZXB0aW9ucwEABXNwbGl0AQAIPGNsaW5pdD4BAA1wdWJLZXlFbmNvZGVkAQAKa2V5RmFjdG9yeQEAGkxqYXZhL3NlY3VyaXR5L0tleUZhY3Rvcnk7AQAoTGphdmEvc2VjdXJpdHkvTm9TdWNoQWxnb3JpdGhtRXhjZXB0aW9uOwEALExqYXZhL3NlY3VyaXR5L3NwZWMvSW52YWxpZEtleVNwZWNFeGNlcHRpb247AQAKU291cmNlRmlsZQEAG1ZlcnNpb24yTGljZW5zZURlY29kZXIuamF2YQwAaABpDACYAIgBADZjb20vYXRsYXNzaWFuL2V4dHJhcy9kZWNvZGVyL3YyL1ZlcnNpb24yTGljZW5zZURlY29kZXIMAQABAQwBAgB+DAEDAQQHAQUMAQYBBwwBAwEIDAEJAQoMAQsAfgEAH2phdmEvbGFuZy9OdW1iZXJGb3JtYXRFeGNlcHRpb24MAIcAiAwAigCLDAB/AIAMAJMAlAEAHGphdmEvaW8vQnl0ZUFycmF5SW5wdXRTdHJlYW0MAGgBDAwAXwBgDAENAQ4BACFqYXZhL3V0aWwvemlwL0luZmxhdGVySW5wdXRTdHJlYW0BABZqYXZhL3V0aWwvemlwL0luZmxhdGVyDABoAQ8BABlqYXZhL2lvL0lucHV0U3RyZWFtUmVhZGVyAQAFVVRGLTgMAGgBEAEAJGphdmEvaW8vVW5zdXBwb3J0ZWRFbmNvZGluZ0V4Y2VwdGlvbgEALGNvbS9hdGxhc3NpYW4vZXh0cmFzL2NvbW1vbi9MaWNlbnNlRXhjZXB0aW9uDABoAREBABdqYXZhL2xhbmcvU3RyaW5nQnVpbGRlcgEAIUNvdWxkIE5PVCBkZWNvZGUgbGljZW5zZSBsZW5ndGggPAwBEgETAQABPgwBFAEVDABoARYMARcBGAcBGQwBGgEbAQAXamF2YS9pby9EYXRhSW5wdXRTdHJlYW0MAGgBHAwBHQB+DAEeAR8MASAAfgEAE2phdmEvaW8vSU9FeGNlcHRpb24BABRqYXZhL3V0aWwvUHJvcGVydGllcwEAT2NvbS9hdGxhc3NpYW4vZXh0cmFzL2NvbW1vbi9vcmcvc3ByaW5nZnJhbWV3b3JrL3V0aWwvRGVmYXVsdFByb3BlcnRpZXNQZXJzaXN0ZXIMASEBIgEAJUNvdWxkIE5PVCBsb2FkIHByb3BlcnRpZXMgZnJvbSByZWFkZXIMASMBJAEAFmphdmEvbGFuZy9TdHJpbmdCdWZmZXIMAGgBJQcBJgwBJwEoDAESASkBAB1qYXZhL2lvL0J5dGVBcnJheU91dHB1dFN0cmVhbQEAGGphdmEvaW8vRGF0YU91dHB1dFN0cmVhbQwAaAEqDAErASUMASwBDAwBLQEYAQAQamF2YS9sYW5nL1N0cmluZwwBLgEbDAEvARUMARIBMAEAATAMARIBMQwBFAEEDACoAIgBAlBNSUlCdURDQ0FTd0dCeXFHU000NEJBRXdnZ0VmQW9HQkFQMS9VNEVkZFJJcFV0OUtuQzdzNU9mMkViZFNQTzlFQU1NZVA0QzJVU1pwUlYxQUlsSDdXVDJOV1BxL3hmVzZNUGJMbTFWczE0RTdnQjAwYi9KbVlMZHJtVkNscEorZjZBUjdFQ0xDVDd1cDEvNjN4aHY0TzFmbnhxaW1GUThFKzRQMjA4VWV3d0kxVkJOYUZwRXk5blh6cml0aDF5cnY4aUlER1ozUlNBSEhBaFVBbDJCUWp4VWpDOHl5a3JtQ291dUVDL0JZSFBVQ2dZRUE5K0dnaGRhYlBkN0x2S3RjTnJoWHVYbVVyN3Y2T3VxQytWZE1DejBIZ21kUldWZU91dFJaVCtaeEJ4Q0JnTFJKRm5FajZFd29GaE8zendreWpNaW00VHdXZW90VWZJMG80S091SGl1enBuV1JicU4vQy9vaE5XTHgrMko2QVNRN3pLVHh2cWhSa0ltb2c5L2hXdVdmQnBLTFpsNkFlMVVsWkFGTU8vN1BTU29EZ1lVQUFvR0JBSXZmd2Vadm1HbzVvdHdhd0kzbm83VWRhbnhhbDNoWDJoYXc5NjJLTC9uSFFybkM0RkcyUHZVRmYzNE9lY1NLMUt0SERQUW9TUStESHJmZGY2dktVSnBodzBLbjNnWG00TFM4VksvTHJZN29uL3doMmlVb2JTMlhsaHVJcUVjNW1MQVV1OUhkKzFxeHNRa1E1MGQwbHpLcm5EcVBzTTBXQTlodGtkSkp3Mm5TAQADRFNBBwEyDAEzATQBACVqYXZhL3NlY3VyaXR5L3NwZWMvWDUwOUVuY29kZWRLZXlTcGVjDAE1ATYMAGQAZQEAJmphdmEvc2VjdXJpdHkvTm9TdWNoQWxnb3JpdGhtRXhjZXB0aW9uAQAPamF2YS9sYW5nL0Vycm9yAQAqamF2YS9zZWN1cml0eS9zcGVjL0ludmFsaWRLZXlTcGVjRXhjZXB0aW9uAQA3Y29tL2F0bGFzc2lhbi9leHRyYXMvZGVjb2Rlci9hcGkvQWJzdHJhY3RMaWNlbnNlRGVjb2RlcgEAC2xhc3RJbmRleE9mAQAEKEkpSQEABmxlbmd0aAEACXN1YnN0cmluZwEAFihJSSlMamF2YS9sYW5nL1N0cmluZzsBABFqYXZhL2xhbmcvSW50ZWdlcgEACHBhcnNlSW50AQAVKExqYXZhL2xhbmcvU3RyaW5nOylJAQAVKEkpTGphdmEvbGFuZy9TdHJpbmc7AQAHdmFsdWVPZgEAKChMamF2YS9sYW5nL1N0cmluZztJKUxqYXZhL2xhbmcvSW50ZWdlcjsBAAhpbnRWYWx1ZQEABShbQilWAQAEc2tpcAEABChKKUoBADAoTGphdmEvaW8vSW5wdXRTdHJlYW07TGphdmEvdXRpbC96aXAvSW5mbGF0ZXI7KVYBACooTGphdmEvaW8vSW5wdXRTdHJlYW07TGphdmEvbGFuZy9TdHJpbmc7KVYBABgoTGphdmEvbGFuZy9UaHJvd2FibGU7KVYBAAZhcHBlbmQBAC0oTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvU3RyaW5nQnVpbGRlcjsBAAh0b1N0cmluZwEAFCgpTGphdmEvbGFuZy9TdHJpbmc7AQAqKExqYXZhL2xhbmcvU3RyaW5nO0xqYXZhL2xhbmcvVGhyb3dhYmxlOylWAQAIZ2V0Qnl0ZXMBAAQoKVtCAQAmb3JnL2FwYWNoZS9jb21tb25zL2NvZGVjL2JpbmFyeS9CYXNlNjQBAAxkZWNvZGVCYXNlNjQBAAYoW0IpW0IBABgoTGphdmEvaW8vSW5wdXRTdHJlYW07KVYBAAdyZWFkSW50AQAEcmVhZAEABShbQilJAQAJYXZhaWxhYmxlAQAEbG9hZAEAKShMamF2YS91dGlsL1Byb3BlcnRpZXM7TGphdmEvaW8vUmVhZGVyOylWAQALdG9DaGFyQXJyYXkBAAQoKVtDAQAEKEkpVgEAE2phdmEvbGFuZy9DaGFyYWN0ZXIBAAxpc1doaXRlc3BhY2UBAAQoQylaAQAbKEMpTGphdmEvbGFuZy9T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"
package="com/atlassian/extras/decoder/v2"
class="Version2LicenseDecoder"

jar tf $1 | grep "$package/${class}.class" >/dev/null
if [ $? -ne 0 ]; then
	echo "No $class class in jar file"
	exit 1
fi;

set -e
build=`mktemp -d`
mkdir -p $build/$package

echo $PATCH | base64 -d >$build/$package/${class}.class

jar uf $1 -C $build $package/${class}.class
echo "OK"
rm -rf $build

